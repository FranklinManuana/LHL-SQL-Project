Answer the following questions and provide the SQL queries used to find the answer.

    
**Question 1: Which cities and countries have the highest level of transaction revenues on the site?**


SQL Queries:

SELECT country,city, SUM(total_transaction_revenue) as TotalTransactionRevenue
FROM 
	(SELECT DISTINCT LOWER(TRIM(country)) as Country, LOWER(TRIM(city)) as City,
	ROUND(SUM(totaltransactionrevenue/1000000), 2) as total_transaction_revenue,productsku,
	ROUND((productprice/1000000), 2) as Product_Price,productname
	FROM all_sessions
	WHERE totaltransactionrevenue IS NOT NULL AND city NOT LIKE 'not%' AND city NOT LIKE '(not%'
	GROUP BY city, country,productsku,productprice,productname
	ORDER BY total_transaction_revenue DESC) AS cleaned_alls
GROUP BY country,city
ORDER BY TotalTransactionRevenue DESC


Answer: Website revenue can be traced to the following countries: united states, australia, canada, switzerland, and israel. The bulk of the revenue is being generated by the united states with the top 5 american cities being san francisco, sunnyvale,atlanta, palo alto, and new york.


**Question 2: What is the average number of products ordered from visitors in each city and country?**


SQL Queries:
SELECT LOWER(TRIM(city)) as city,LOWER(TRIM(country)) as country, 
ROUND(AVG(visitor_total_quantity), 2) as avg_products_ordered_per_visitor
FROM (
	SELECT fullvisitorid, city, country, SUM(productquantity) as visitor_total_quantity
	FROM all_sessions
	WHERE productquantity IS NOT NULL
	GROUP BY fullvisitorid, city, country) AS visitor_orders
WHERE city NOT LIKE '%not%'
GROUP BY city, country
ORDER BY avg_products_ordered_per_visitor DESC;


Answer: Madrid Spain has the highest average ordered products however the order was never completed.





**Question 3: Is there any pattern in the types (product categories) of products ordered from visitors in each city and country?**


SQL Queries:

SELECT alls.productcategory, COUNT(alls.productcategory) as number_products_in_category, alls.country
FROM all_sessions alls
JOIN (SELECT DISTINCT fullvisitorid, productcategory,city,country FROM all_sessions) allss
ON alls.productcategory = allss.productcategory
WHERE alls.city NOT LIKE '%not%' AND alls.totaltransactionrevenue IS NOT NULL
GROUP BY alls.productcategory, alls.country
ORDER BY alls.country, number_products_in_category DESC


Answer:
After reviewing the data we notice that products in the NEST categories has fewer
product options than the home appearls yet produce the most revenue.



**Question 4: What is the top-selling product from each city/country? Can we find any pattern worthy of noting in the products sold?**


SQL Queries:

SELECT DISTINCT productname,LOWER(TRIM(city)) as city,LOWER(TRIM(country)) as country,
ROUND(SUM(totaltransactionrevenue / 1000000), 2) as total_product_revenue
FROM all_sessions 
WHERE totaltransactionrevenue IS NOT NULL AND  city NOT LIKE '%not%'
GROUP by productname,country,city
ORDER BY total_product_revenue DESC

Answer: 

The highest selling product is reusable shopping bags for Atlanta, US, followed
by lip balm in Sunnyvale. After that we notice that the next 8 highest sold products in the 
united states are nest security products.





**Question 5: Can we summarize the impact of revenue generated from each city/country?**

SQL Queries:



Answer:







